// Blast Corps (U) (V1.1).z64 patch to use ROM lookup table
// Updated: 2016 Feb 03
// By: queueRAM
// For updates, check: http://origami64.net/showthread.php?tid=334&pid=2566

// Use with N64 version of bass: https://github.com/ARM9/bass
// > bass -o "Blast Corps (U) (V1.1).z64" blast_corps_rom.asm

arch n64.cpu
endian msb

include "mips4300.inc"

// TODO: update end offset of code
// origin 0x2A4C
// addiu a3, a3, 0x3acc

// overwrite old chimp level
origin 0x4ACC10
fill 0x4B8960-0x4ACC10

// new code
origin 0x787FD0
insert "bin/hd_code_text.raw.gz"
insert "bin/hd_code_data.raw.gz"
// ensure new code isn't too large
if pc() > 0x7E3AD0 {
   error "code + data > 0x7E3AD0"
}

fill 0x7E3AD0-pc()

// Level LUT
// TODO: relocate other levels
origin 0x7FA000
//dd 0x4ACC10, 0x4B71AB, 0x4B71AB, 0x4B8960
dd chimp_start, chimp_dl, chimp_dl, chimp_end
dd 0x4A5660, 0x4ABF91, 0x4ABF91, 0x4ACC10
dd 0x4B8960, 0x4BEDE5, 0x4BEDE5, 0x4BFD60
dd 0x4BFD60, 0x4C3247, 0x4C3247, 0x4C3AC0
dd 0x4C3AC0, 0x4D3B76, 0x4D3B76, 0x4D5F90
dd 0x4D5F90, 0x4E1838, 0x4E1838, 0x4E2F70
dd 0x4E2F70, 0x4E48E4, 0x4E48E4, 0x4E4E80
dd 0x4E4E80, 0x4E7458, 0x4E7458, 0x4E7C00
dd 0x4E7C00, 0x4E8BF7, 0x4E8BF7, 0x4E8F70
dd 0x4E8F70, 0x4F441E, 0x4F441E, 0x4F5C10
dd 0x4F5C10, 0x4FF4C1, 0x4FF4C1, 0x500520
dd 0x500520, 0x506D73, 0x506D73, 0x507E80
dd 0x507E80, 0x51014A, 0x51014A, 0x511340
dd 0x511340, 0x5213B7, 0x5213B7, 0x523080
dd 0x523080, 0x52B974, 0x52B974, 0x52CD00
dd 0x52CD00, 0x531885, 0x531885, 0x532700
dd 0x532700, 0x53D32E, 0x53D32E, 0x53E9B0
dd 0x53E9B0, 0x54909A, 0x54909A, 0x54A820
dd 0x54A820, 0x551DAA, 0x551DAA, 0x552DE0
dd 0x552DE0, 0x554A33, 0x554A33, 0x555000
dd 0x555000, 0x55F205, 0x55F205, 0x560E90
dd 0x560E90, 0x5646CB, 0x5646CB, 0x5652D0
dd 0x5652D0, 0x56E0F7, 0x56E0F7, 0x56F3F0
dd 0x56F3F0, 0x571E88, 0x571E88, 0x5721E0
dd 0x5721E0, 0x573354, 0x573354, 0x5736E0
dd 0x5736E0, 0x5795B8, 0x5795B8, 0x57A2C0
dd 0x57A2C0, 0x58005F, 0x58005F, 0x580B60
dd 0x580B60, 0x587CA0, 0x587CA0, 0x588CE0
dd 0x588CE0, 0x58B53D, 0x58B53D, 0x58BE80
dd 0x58BE80, 0x596201, 0x596201, 0x597B80
dd 0x597B80, 0x59AEC7, 0x59AEC7, 0x59B7D0
dd 0x59B7D0, 0x5A4451, 0x5A4451, 0x5A5840
dd 0x5A5840, 0x5AF6C1, 0x5AF6C1, 0x5B0B10
dd 0x5B0B10, 0x5B4E60, 0x5B4E60, 0x5B5A30
dd 0x5B5A30, 0x5B850E, 0x5B850E, 0x5B8BB0
dd 0x5B8BB0, 0x5C366C, 0x5C366C, 0x5C4C80
dd 0x5C4C80, 0x5C9D2D, 0x5C9D2D, 0x5CA9C0
dd 0x5CA9C0, 0x5CC86E, 0x5CC86E, 0x5CCF50
dd 0x5CCF50, 0x5D07B8, 0x5D07B8, 0x5D1060
dd 0x5D1060, 0x5DB0FC, 0x5DB0FC, 0x5DC830
dd 0x5DC830, 0x5E5B29, 0x5E5B29, 0x5E6EE0
dd 0x5E6EE0, 0x5EB4C8, 0x5EB4C8, 0x5EC800
dd 0x5EC800, 0x5F2C67, 0x5F2C67, 0x5F3A80
dd 0x5F3A80, 0x5FFF79, 0x5FFF79, 0x6014B0
dd 0x6014B0, 0x6095C1, 0x6095C1, 0x60A710
dd 0x60A710, 0x6126C5, 0x6126C5, 0x613AA0
dd 0x613AA0, 0x61C88C, 0x61C88C, 0x61DD70
dd 0x61DD70, 0x6211ED, 0x6211ED, 0x621AF0
dd 0x621AF0, 0x625CAC, 0x625CAC, 0x6269E0
dd 0x6269E0, 0x62F871, 0x62F871, 0x630C30
dd 0x630C30, 0x634D35, 0x634D35, 0x635700
dd 0x635700, 0x63BD00, 0x63BD00, 0x63CA10
dd 0x63CA10, 0x6416D6, 0x6416D6, 0x641F30
dd 0x641F30, 0x6440CC, 0x6440CC, 0x644810
dd 0x644810, 0x645D55, 0x645D55, 0x646080
dd 0x646080, 0x6470B7, 0x6470B7, 0x647550
dd 0x647550, 0x65362E, 0x65362E, 0x654FC0
dd 0x654FC0, 0x65F329, 0x65F329, 0x660950
dd 0x660950, 0x66550A, 0x66550A, 0x665F80
dd 0x665F80, 0x66BB49, 0x66BB49, 0x66C900

// append level at end
origin 0x800000
chimp_start:
insert "bin/chimp.raw.gz"
chimp_dl:
insert "bin/chimp_dl.raw.gz"
chimp_end: